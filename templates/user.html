{% extends "base.html" %}

{% block head %}
    <title>Research Engine | {{page_user.username.capitalize()}}</title>
    <link href="/css/user.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript">
      var toggleVisibility = function (item) {
        var infoDiv = item.parentElement.getElementsByClassName('description')[0];
        console.log(infoDiv);
        if (item.innerHTML.trim() == 'Show description') {
          item.innerHTML = 'Hide description';
          infoDiv.style.maxHeight = '30em';
        } else {
          item.innerHTML = 'Show description';
          infoDiv.style.maxHeight = '0em';
        }
      };
  </script>

{% endblock %}


{% block content %}

<div class="u-info">
  <div class="u-name">{{page_user.username.capitalize()}}</div>
  <img src="{{page_user.get_profile_image(120)}}">
  <div class="u-about">{% if page_user.about_me %}{{page_user.about_me.replace("\n", "<br/>") | safe}}{% endif %}</div>
  {% if self_user_p %}<div class="u-settings"><a href="/settings">Account settings</a></div>{% endif %}
</div>

<div class="u-pwrapper">
  <div class="u-phead">
    {% if self_user_p %}<div class="button1"><a href="{{button_link}}">{{button_text}}</a></div>{% endif %}
    <h2>Projects</h2>
  </div>
  {% for p in projects %} 
    <div class="u-project">
      <a class="info-link" href="#" onClick="toggleVisibility(this);">Show description</a>
      <div class="name"><a href="/{{p.key.integer_id()}}">{{p.name}}</a></div>
      <div class="description"><br/>{{p.description | md | safe}}<div class="u-pupdated">Last updated: {{p.last_updated.strftime("%d-%b-%Y")}}</div>
      </div>
    </div>
  {% endfor %}
</div>


{% endblock %}
